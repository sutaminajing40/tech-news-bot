# Tech News Bot v2.0 - Product Requirements Document

## 1. 背景・目的

### 1.1 背景

エンジニアとして技術の進歩についていくために、日々の技術情報キャッチアップが必要不可欠である。しかし、多数の技術サイトを個別にチェックするのは非効率で、継続が困難である。

### 1.2 目的

- **技術情報の効率的な収集**: はてなブックマーク技術カテゴリの TOP5 記事を自動収集
- **継続可能なキャッチアップ**: Slack 内で完結する使いやすいシステム
- **深い理解の促進**: LLM を活用した詳細要約と質問機能の提供
- **実装の簡素化**: 保守性と継続性を重視したシンプルなアーキテクチャ

## 2. 現状システムの課題

### 2.1 現在の Tech News Bot v1.0

- **機能**: 毎日正午 12 時に技術記事 TOP5 + 簡単要約を Slack 投稿
- **技術**: GitHub Actions + Python + Gemini API + Slack Webhook
- **制限**:
  - 詳細要約機能なし
  - 質問機能なし
  - 一方的な情報配信のみ

### 2.2 主要課題

1. **インタラクティブ機能の欠如**: より詳しく知りたい記事への深掘りができない
2. **質問機能の不在**: 記事内容への疑問を解決する手段がない
3. **継続性の問題**: 受動的な情報受信のみで能動的な学習につながりにくい

## 3. 製品要件

### 3.1 機能要件

#### 3.1.1 コア機能（現行維持）

- **F001**: 毎日正午 12 時 JST に技術記事 TOP5 を自動取得
- **F002**: Gemini API による各記事の簡潔要約（2-3 文）
- **F003**: Slack チャンネルへの自動投稿

#### 3.1.2 新規機能

- **F004**: 詳細要約機能

  - 各記事にボタンを配置
  - ワンクリックで Gemini API による詳細要約を生成・表示
  - スレッド返信形式で投稿

- **F005**: 質問機能
  - 各記事に質問ボタンを配置
  - モーダル入力での質問受付
  - Gemini API による記事内容に基づく回答生成
  - スレッド返信形式で回答投稿

### 3.2 非機能要件

#### 3.2.1 ユーザビリティ

- **UX001**: スマートフォンでの操作性を最優先
- **UX002**: Slack 内での完結（外部サイトへの遷移なし）
- **UX003**: ワンクリック・ワンタップでの操作完了

#### 3.2.2 パフォーマンス

- **P001**: ボタンクリック後の応答時間：10 秒以内
- **P002**: 質問機能の応答時間：15 秒以内
- **P003**: システム全体の可用性：99%以上

#### 3.2.3 拡張性・保守性

- **M001**: ファイル数最小化（2 ファイル以内）
- **M002**: データベース不要のステートレス設計
- **M003**: 複雑な状態管理の排除

### 3.3 制約条件

- **C001**: 既存の GitHub Actions 実行環境を維持
- **C002**: Slack Workspace 内での動作
- **C003**: 外部データベースサービスの使用禁止（コスト・複雑性削減）
- **C004**: Gemini API 使用量の最適化

## 4. ユーザーストーリー

### 4.1 基本シナリオ

```
As an エンジニア
I want 毎日の技術記事要約をSlackで受け取り
So that 最新の技術トレンドを効率的にキャッチアップできる
```

### 4.2 詳細要約シナリオ

```
As an エンジニア
I want 興味のある記事の詳細要約をワンクリックで取得したい
So that 記事の内容を深く理解して実務に活かせる
```

### 4.3 質問シナリオ

```
As an エンジニア
I want 記事に対して質問をして回答を得たい
So that 不明な点を解決して確実に理解を深められる
```

## 5. 成功指標

### 5.1 利用指標

- **日次投稿の継続率**: 95%以上
- **詳細要約機能の利用率**: 1 日あたり平均 2 回以上
- **質問機能の利用率**: 1 週間あたり平均 3 回以上

### 5.2 技術指標

- **システム稼働率**: 99%以上
- **応答時間**: 上記非機能要件の達成
- **エラー率**: 1%以下

### 5.3 ビジネス指標

- **技術キャッチアップ効率**: 従来比 50%以上の時間短縮
- **技術知識の定着率**: 質問機能利用により理解度向上

## 6. リリース計画

### 6.1 Phase 1: 基盤システム構築

- 現行システムの Slack Interactive Components 対応
- 詳細要約機能の実装
- 基本的なエラーハンドリング

### 6.2 Phase 2: 質問機能追加

- 質問モーダルの実装
- Gemini API との質問応答連携
- ユーザーフィードバック収集・改善

### 6.3 Phase 3: 最適化・安定化

- パフォーマンス改善
- エラーハンドリングの強化
- 運用監視の充実

## 7. 運用コスト分析

### 7.1 無料サービス（完全無料）

#### GitHub Actions
- **無料枠**: パブリックリポジトリは無制限使用
- **使用量**: 毎日5分程度の実行
- **コスト**: **完全無料**

#### Vercel Functions
- **無料枠**: 月100,000リクエスト、実行時間100時間
- **予想使用量**: 
  - 詳細要約: 1日2回 × 30日 = 60回/月
  - 質問機能: 週3回 × 4週 = 12回/月
  - **合計**: 約72回/月
- **コスト**: **完全無料**（無料枠内）

#### Slack API
- **料金**: API呼び出しに課金なし
- **コスト**: **完全無料**

### 7.2 従量課金サービス

#### Gemini 2.5 Flash API
- **無料枠**: 1日1,500リクエスト、月150万トークン
- **予想使用量**:
  ```
  毎日の使用量:
  - 記事要約5件: 約5,000トークン
  - 詳細要約2件: 約4,000トークン  
  - 質問回答3件: 約3,000トークン
  合計: 約12,000トークン/日
  
  月間使用量: 12,000 × 30 = 360,000トークン
  ```
- **無料枠との比較**: 36万トークン < 150万トークン（無料枠）
- **コスト**: **完全無料**

#### 無料枠超過時のコスト
- **料金**: $0.075/100万トークン
- **仮に月100万トークン使用**: $0.075 = 約11円/月

### 7.3 総運用コスト

- **通常運用**: **完全無料**
- **大量使用時**: 月数十円程度
- **年間コスト**: **実質0円**

### 7.4 コスト最適化戦略

#### トークン使用量削減
- プロンプト最適化による応答短縮
- 不要な詳細要約の抑制
- キャッシュ機能の活用（将来拡張）

#### 監視・アラート
- 月次使用量の監視
- 無料枠80%到達時のアラート
- 使用パターンの分析と最適化
